# cosmosR

## Overview

COSMOS (Causal Oriented Search of Multi-Omic Space) is a method that
integrates phosphoproteomics, transcriptomics, and metabolomics data
sets. COSMOS leverages extensive prior knowledge of signaling pathways,
metabolic networks, and gene regulation with computational methods to
estimate activities of transcription factors and kinases as well as
network-level causal reasoning. This pipeline can provide mechanistic
explanations for experimental observations across multiple omic data
sets.

![](reference/figures/intro_data.png)

COSMOS finds coherent subnetwork causally connecting as many deregulated
TFs, kinases/phosphatases and metabolites as possible. The subnetwork is
extracted from a novel integrated PKN (available
[here](http://metapkn.omnipathdb.org/)) spanning signaling,
transcriptional regulation and metabolism. Transcription factors
activities are inferred from gene expression with
[decoupleR](https://saezlab.github.io/decoupleR/). Kinase activities are
inferred from phosphoproteomic with a kinase/substrate network of
[Omnipath](http://omnipathdb.org/), a meta resource of protein-protein.
The scripts to generate the current network can be found here:
<https://github.com/saezlab/meta_PKN_BIGG>.

You can also use COSMOS if you don’t have metabolomic data, to connect
TF activities (from transcriptomic) with kinase activities (from
phosphoproteomic) for exmaple !

![](reference/figures/graphical_abstract.png)

## Installation

R \>= 4.1 is required

``` r
# We advise to instal from github to get the latest version of the tool.
if (!requireNamespace("devtools", quietly = TRUE))
    install.packages("devtools")
    
devtools::install_github("saezlab/cosmosR")
```

If you don’t have R 4.1, you can also clone the github repository on
your machine, create a new R project with R studio from the cosmosR
folder, change the R version to your own R version in the DESCRIPTION
file and then install it with devtools:install()

But 4.1 is advised in any case.

## tutorial to use MOFA and COSMOS

[Here](https://github.com/saezlab/Factor_COSMOS/) you can find an
extensive tutorial showing how to use MOFA and COSMOS with the NCI60
dataset. This is an extensive tutorial, if you wish to get a quicker
plug and play introduction to COSMOS, see below.

!!! THIS is were you can find the input data and the pre-processing
scripts that corespond to the featured vignette !!!

## Tutorial (NCI60 playground)

We made a repository that contains pre-processed inputs and an example
script to use cosmos with the NCI60 RNA+metabolomic datasets. You can
find the repository [here](https://github.com/saezlab/COSMOS_basic).

!!! THIS is were you can find the input data and the pre-processing
scripts that corespond to the featured vignette !!!

## Access

The meta PKN used with the older biorXiv version of COSMOS (2021) is
available [here](http://metapkn.omnipathdb.org/).

An updated meta PKN is available with the package (using
data(meta_network) in R)

## Citation

If you use cosmosR for your research please cite [COSMOS+
preprint](https://www.biorxiv.org/content/10.1101/2024.07.15.603538v2)
Dugourd A, Lafrenz P, Mañanes D, Fallegger R, Kroger AC, Turei D,
Shtylla B, Saez-Rodriguez J; Modeling causal signal propagation in
multi-omic factor space with COSMOS; BioRxiv. 2024 Jul 17 DOI:
10.1101/2024.07.15.603538

The first publication of COSMOS is MSB can be found
[here](https://www.embopress.org/doi/full/10.15252/msb.20209730):

## License

The code is distributed under the GNU General Public License v3.0. The
meta PKN is distributed under the Attribution-NonCommercial 4.0
International (CC-BY-NC 4.0) License.

# Package index

## All functions

- [`HMDB_mapper_vec`](HMDB_mapper_vec.md) : Toy Input Transcription Data
  Set
- [`compress_same_children()`](compress_same_children.md) : Compress
  Network by Merging Nodes with Identical Children
- [`cosmos_data()`](cosmos_data.md) : Create Cosmos Data
- [`createLinearColors()`](createLinearColors.md) : Create Linear Colors
  Based on Numeric Input
- [`decompress_moon_result()`](decompress_moon_result.md) : Decompress
  Moon Result
- [`decompress_solution_network()`](decompress_solution_network.md) :
  Decompress Solution Network
- [`decoupleRnival()`](decoupleRnival.md) : DecoupleRnival
- [`default_CARNIVAL_options()`](default_CARNIVAL_options.md) : Setting
  Default CARNIVAL Options
- [`display_node_neighboorhood()`](display_node_neighboorhood.md) :
  display_node_neighboorhood
- [`extract_nodes_for_ORA()`](extract_nodes_for_ORA.md) : Extract COSMOS
  nodes for ORA analysis
- [`filter_incohrent_TF_target()`](filter_incohrent_TF_target.md) :
  filter_incohrent_TF_target
- [`format_COSMOS_res()`](format_COSMOS_res.md) : format_COSMOS_res
- [`format_LR_ressource()`](format_LR_ressource.md) : Format
  Ligand-Receptor Resource
- [`get_moon_scoring_network()`](get_moon_scoring_network.md) : Get Moon
  Scoring Network
- [`gmt_to_dataframe()`](gmt_to_dataframe.md) : Convert gmt file to data
  frame
- [`load_tf_regulon_dorothea()`](load_tf_regulon_dorothea.md) : load
  transcription factor regulon
- [`make_heatmap_color_palette()`](make_heatmap_color_palette.md) :
  Create Heatmap Color Palette
- [`meta_network`](meta_network.md) : Meta Prior Knowledge Network
- [`meta_network_cleanup()`](meta_network_cleanup.md) :
  meta_network_cleanup
- [`moon()`](moon.md) : moon
- [`prepare_metab_inputs()`](prepare_metab_inputs.md) : add metabolic
  compartment and metab\_\_ prefix to metabolite IDs
- [`preprocess_COSMOS_metabolism_to_signaling()`](preprocess_COSMOS_metabolism_to_signaling.md)
  : Preprocess COSMOS Inputs For Metabolism to Signaling
- [`preprocess_COSMOS_signaling_to_metabolism()`](preprocess_COSMOS_signaling_to_metabolism.md)
  : Preprocess COSMOS Inputs For Signaling to Metabolism
- [`print(`*`<cosmos_data>`*`)`](print.cosmos_data.md) : Print Cosmos
  Data Summary Print a summary of cosmos data.
- [`reduce_solution_network()`](reduce_solution_network.md) :
  reduce_solution_network
- [`reduce_solution_network_double_thresh()`](reduce_solution_network_double_thresh.md)
  : reduce_solution_network_double_thresh
- [`run_COSMOS_metabolism_to_signaling()`](run_COSMOS_metabolism_to_signaling.md)
  : run COSMOS metabolism to signaling
- [`run_COSMOS_signaling_to_metabolism()`](run_COSMOS_signaling_to_metabolism.md)
  : run COSMOS signaling to metabolism
- [`toy_RNA`](toy_RNA.md) : Toy Input Transcription Data Set
- [`toy_metabolic_input`](toy_metabolic_input.md) : Toy Metabolic Input
  Data
- [`toy_network`](toy_network.md) : Toy Input Network
- [`toy_signaling_input`](toy_signaling_input.md) : Toy Signaling Input
- [`translate_column_HMDB()`](translate_column_HMDB.md) : Translate
  Column Using HMDB Mapper
- [`translate_res()`](translate_res.md) : translate_res
- [`wide_ulm_res()`](wide_ulm_res.md) : Convert ULM Results to Wide
  Format

# Articles

### All vignettes

- [MOFA to COSMOS tutorial](MOFA_to_COSMOS.md):
- [NCI60 tutorial](NCI60_tutorial.md):
- [COSMOS-tutorial](tutorial.md):
