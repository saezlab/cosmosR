<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Preprocess COSMOS Inputs For Signaling to Metabolism — preprocess_COSMOS_signaling_to_metabolism • cosmosR</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Preprocess COSMOS Inputs For Signaling to Metabolism — preprocess_COSMOS_signaling_to_metabolism" />
<meta property="og:description" content="Runs checks on the input data and simplifies the prior knowledge network.
Simplification includes the removal of (1) nodes that are not reachable from 
signaling nodes and  (2) interactions between transcription factors and target
genes if the target gene does not respond or the response is contradictory
with the change in the transcription factor activity. 
Optionally, further TF activities are estimated via network optimization via
CARNIVAL and the interactions between TF and genes are filtered again." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PV71G2Q3SF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PV71G2Q3SF');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cosmosR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/tutorial.html">COSMOS-tutorial</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/saezlab/COSMOSR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/saezlab">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../www.saezlab.org">
    <span class="fas fa-university"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Preprocess COSMOS Inputs For Signaling to Metabolism</h1>
    <small class="dont-index">Source: <a href='https://github.com/saezlab/COSMOSR/blob/master/R/preprocess_COSMOS_signaling_to_metabolism.R'><code>R/preprocess_COSMOS_signaling_to_metabolism.R</code></a></small>
    <div class="hidden name"><code>preprocess_COSMOS_signaling_to_metabolism.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Runs checks on the input data and simplifies the prior knowledge network.
Simplification includes the removal of (1) nodes that are not reachable from 
signaling nodes and  (2) interactions between transcription factors and target
genes if the target gene does not respond or the response is contradictory
with the change in the transcription factor activity. 
Optionally, further TF activities are estimated via network optimization via
CARNIVAL and the interactions between TF and genes are filtered again.</p>
    </div>

    <pre class="usage"><span class='fu'>preprocess_COSMOS_signaling_to_metabolism</span><span class='op'>(</span>
  meta_network <span class='op'>=</span> <span class='va'>meta_network</span>,
  tf_regulon <span class='op'>=</span> <span class='fu'><a href='load_tf_regulon_dorothea.html'>load_tf_regulon_dorothea</a></span><span class='op'>(</span><span class='op'>)</span>,
  <span class='va'>signaling_data</span>,
  <span class='va'>metabolic_data</span>,
  <span class='va'>diff_expression_data</span>,
  diff_exp_threshold <span class='op'>=</span> <span class='fl'>1</span>,
  maximum_network_depth <span class='op'>=</span> <span class='fl'>8</span>,
  expressed_genes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>diff_expression_data</span><span class='op'>)</span><span class='op'>[</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>diff_expression_data</span><span class='op'>)</span><span class='op'>]</span>,
  remove_unexpressed_nodes <span class='op'>=</span> <span class='cn'>TRUE</span>,
  filter_tf_gene_interaction_by_optimization <span class='op'>=</span> <span class='cn'>TRUE</span>,
  CARNIVAL_options <span class='op'>=</span> <span class='fu'><a href='default_CARNIVAL_options.html'>default_CARNIVAL_options</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>meta_network</th>
      <td><p>prior knowledge network. By default COSMOS use a PKN 
derived from Omnipath, STITCHdb and Recon3D. See details on the data 
<code><a href='meta_network.html'>meta_network</a></code>.</p></td>
    </tr>
    <tr>
      <th>tf_regulon</th>
      <td><p>collection of transcription factor - target interactions.
A default collection from dorothea can be obtained by the 
<code><a href='load_tf_regulon_dorothea.html'>load_tf_regulon_dorothea</a></code> function.</p></td>
    </tr>
    <tr>
      <th>signaling_data</th>
      <td><p>numerical vector, where names are signaling nodes 
in the PKN and values are from {1, 0, -1}. Continuous data will be 
discretized using the <code><a href='https://rdrr.io/r/base/sign.html'>sign</a></code> function.</p></td>
    </tr>
    <tr>
      <th>metabolic_data</th>
      <td><p>numerical vector, where names are metabolic nodes 
in the PKN and values are continuous values that represents log2 fold change 
or t-values from a differential analysis. These values are compared to 
the simulation results (simulated nodes can take value -1, 0 or 1)</p></td>
    </tr>
    <tr>
      <th>diff_expression_data</th>
      <td><p>(optional) numerical vector that represents the 
results of a differential gene expression analysis. Names are gene
names using EntrezID starting with an X and values are log fold change or
 t-values.  <code><a href='convert_genesymbols_to_entrezid.html'>convert_genesymbols_to_entrezid</a></code> can be used for
 conversion.  We use the &#8220;<code>diff_exp_threshold</code>&#8221; parameter to decide
 which genes changed significantly.  Genes with NA values are considered none
 expressed and they will be removed from the TF-gene expression interactions.</p></td>
    </tr>
    <tr>
      <th>diff_exp_threshold</th>
      <td><p>threshold parameter (default 1) used to binarize
the values of &#8220;<code>diff_expression_data</code>&#8221;.</p></td>
    </tr>
    <tr>
      <th>maximum_network_depth</th>
      <td><p>integer &gt; 0 (default: 8). Nodes that are further 
than &#8220;<code>maximum_network_depth</code>&#8221; steps from the signaling nodes on 
the directed graph of the PKN are considered non-reachable and are removed.</p></td>
    </tr>
    <tr>
      <th>expressed_genes</th>
      <td><p>character vector. Names of nodes that are expressed. By 
default we consider all the nodes that appear in <code>diff_expression_data</code> with
a numeric value (i.e. nodes with NA are removed)</p></td>
    </tr>
    <tr>
      <th>remove_unexpressed_nodes</th>
      <td><p>if TRUE (default) removes nodes from the PKN 
that are not expressed, see input &#8220;<code>expressed_genes</code>&#8221;.</p></td>
    </tr>
    <tr>
      <th>filter_tf_gene_interaction_by_optimization</th>
      <td><p>(default:TRUE), if TRUE then runs 
a network optimization that estimates TF activity not included in the inputs
and checks the consistency between the estimated activity and change in gene 
expression. Removes interactions where TF and gene expression are inconsistent</p></td>
    </tr>
    <tr>
      <th>CARNIVAL_options</th>
      <td><p>list that controls the options of CARNIVAL. See details 
in <code><a href='default_CARNIVAL_options.html'>default_CARNIVAL_options</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>cosmos_data object with the following fields:</p><dl>
    <dt><code>meta_network</code></dt><dd><p>Filtered PKN</p></dd>
    <dt><code>tf_regulon</code></dt><dd><p>TF - target regulatory network</p></dd>
    <dt><code>signaling_data_bin</code></dt><dd><p>Binarised signaling data</p></dd> 
    <dt><code>metabolic_data</code></dt><dd><p>Metabolomics data</p></dd>
    <dt><code>diff_expression_data_bin</code></dt><dd><p>Binarized gene expression data</p></dd> 
    <dt><code>optimized_network</code></dt><dd><p>Initial optimized network if 
    <code>filter_tf_gene_interaction_by_optimization is TRUE</code></p></dd>
  
</dl>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='meta_network.html'>meta_network</a></code> for meta PKN,
<code><a href='load_tf_regulon_dorothea.html'>load_tf_regulon_dorothea</a></code> for tf regulon,
<code><a href='convert_genesymbols_to_entrezid.html'>convert_genesymbols_to_entrezid</a></code> for gene conversion,
<code><a href='https://rdrr.io/pkg/CARNIVAL/man/runCARNIVAL.html'>runCARNIVAL</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>CARNIVAL_options</span> <span class='op'>&lt;-</span> <span class='fu'>cosmosR</span><span class='fu'>::</span><span class='fu'><a href='default_CARNIVAL_options.html'>default_CARNIVAL_options</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>CARNIVAL_options</span><span class='op'>$</span><span class='va'>solver</span> <span class='op'>&lt;-</span> <span class='st'>"lpSolve"</span>
<span class='va'>test_for</span> <span class='op'>&lt;-</span> <span class='fu'>preprocess_COSMOS_signaling_to_metabolism</span><span class='op'>(</span>meta_network <span class='op'>=</span> <span class='va'>toy_network</span>,
signaling_data <span class='op'>=</span> <span class='va'>toy_signaling_input</span>,
metabolic_data <span class='op'>=</span> <span class='va'>toy_metabolic_input</span>,
diff_expression_data <span class='op'>=</span> <span class='va'>toy_RNA</span>,
maximum_network_depth <span class='op'>=</span> <span class='fl'>15</span>,
remove_unexpressed_nodes <span class='op'>=</span> <span class='cn'>TRUE</span>,
CARNIVAL_options <span class='op'>=</span> <span class='va'>CARNIVAL_options</span>
<span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>'select()' returned 1:1 mapping between keys and columns</span></div><div class='output co'>#&gt; <span class='message'>'select()' returned 1:many mapping between keys and columns</span></div><div class='output co'>#&gt; [1] "COSMOS: all 2 signaling nodes from data were found in the meta PKN"
#&gt; [1] "COSMOS: all 3 metabolic nodes from data were found in the meta PKN"
#&gt; [1] "COSMOS: 4653 of the 15919 genes in expression data were found as transcription factor target"
#&gt; [1] "COSMOS: 4653 of the 5303 transcription factor targets were found in expression data"
#&gt; [1] "COSMOS: removing unexpressed nodes from PKN..."
#&gt; [1] "COSMOS: 0 interactions removed"
#&gt; [1] "COSMOS: removing nodes that are not reachable from inputs within 15 steps"
#&gt; [1] "COSMOS: 10 from  19 interactions are removed from the PKN"
#&gt; [1] "COSMOS: 1 input/measured nodes are not in PKN any more: XMetab__190___c____ and 0 more."
#&gt; [1] "COSMOS: removing nodes that are not observable by measurements within 15 steps"
#&gt; [1] "COSMOS: 0 from  9 interactions are removed from the PKN"
#&gt; [1] "COSMOS:  1 interactions are removed from the PKN based on consistency check between TF activity and gene expression"
#&gt; [1] "lpSolve does not scale well with large PKNs. This solver is mainly for testing purposes. To run COSMSO, we recommend using cplex, or cbc solvers."
#&gt; [1] "lpSolve does not scale well with large PKNs. This solver is mainly for testing purposes. To run COSMSO, we recommend using cplex, or cbc solvers."</div><div class='output co'>#&gt; <span class='message'>Writing constraints...</span></div><div class='output co'>#&gt; <span class='message'>Solving LP problem...</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'><span style='color: #00BBBB;'>──</span><span> </span><span style='font-weight: bold;'>Column specification</span><span> </span><span style='color: #00BBBB;'>────────────────────────────────────────────────────────</span><span></span>
#&gt; <span class='message'>cols(</span>
#&gt; <span class='message'>  `enter Problem` = </span><span style='color: #BB0000;'>col_character()</span><span></span>
#&gt; <span class='message'>)</span></div><div class='output co'>#&gt; [1] "COSMOS:  0 interactions are removed from the PKN based on consistency check between TF activity and gene expression"</div><div class='output co'>#&gt; <span class='message'>COSMOS: The following signaling nodes are not found in the PKN and will be removed from input: X3725 and 0 more.</span></div><div class='output co'>#&gt; [1] "COSMOS: all 2 metabolic nodes from data were found in the meta PKN"
#&gt; [1] "COSMOS: 4653 of the 15919 genes in expression data were found as transcription factor target"
#&gt; [1] "COSMOS: 4653 of the 5303 transcription factor targets were found in expression data"</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Aurélien Dugourd, Attila Gabor, Katharina Zirngibl.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


